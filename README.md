# sql-kit [![Build Status](https://travis-ci.org/axetroy/sql-kit.svg?branch=master)](https://travis-ci.org/axetroy/sql-kit)

a lib to parser sql-string

### Reference

[go-sql-kit](https://github.com/suboat/go-sql-kit)

> Very useful toolkit for SQL - WHERE & ORDER BY & LIMIT


### API

### sqlKit(params)

@params Object

- query

    - **type**:Object

    - **default**:
    
        ```json
        {}
        ```

- sort

    - **type**:Array

    - **default**:
    
        ```js
        ['-created']
        ```

- meta

    - **type**:Object

    - **default**:
    
        ```ks
        {
            limit:10,
            page:0,
            skip:0
        }
        ```


### sqlKit().clearSort()

clear sort to an empty array

### sqlKit().onlySort(attr)

set the sort in only one element

example
```js
// set sort to ['+created']
new sqlKit().onlySort('+created')
```

### sqlKit().setSort(attr)

set the element to sort array

example
```js
let sqlKit = new sqlKit({
  sort:['+rank','+money']
});

// set sort to ['+created']
sqlKit.setSort('+created')

console.log(sqlKit);
// ['+created','+rank','+money']
```

### sqlKit().pushSort(attr)

push an element to sort array like Array.push

### sqlKit().popSort(attr)

pop an element to sort array like Array.pop

### sqlKit().shiftSort(attr)

shift an element to sort array like Array.shift

### sqlKit().unshiftSort(attr)

unshift an element to sort array like Array.unshift

### sqlKit().removeSort(attr)

remove an element from sort array

example

```js
let sqlKit = new sqlKit({
  sort:['+rank','+money']
});

// set sort to ['+created']
sqlKit.removeSort('rank')

console.log(sqlKit);
// ['+money']
```

### sqlKit().toParams()

compile the sqlKit object to url params object

example
```js
let sqlKit = new sqlKit({
  query:{
    $eq$status:1
  },
  sort:['-created'],
  meta:{
    limit:10,
    page:0,
    skip:0
  }
});

let params = sqlKit.toParams()

console.log(params);
/**
{
  query:"{'%eq':{status:1}}",
  sort:"['-created']",
  limit:10,
  page:0,
  skip:0
}
*/
```

### sqlKit().parserParams()

parser the params which was generated by ``sqlKit().toParams()``

### sqlKit().toString()

recover the prototype method to compile the sqlKit object to sql string

example

```js
let sqlKit = new sqlKit({
  query:{
    $eq$status:1
  },
  sort:['-created'],
  meta:{
    limit:10,
    page:0,
    skip:0
  }
});

let params = sqlKit + ''

console.log(params);
/**
[
  {
    "%eq":{
      stataus:1
    }
  },
  {
    "%o":['-created']
  },
  {
    "%l":10,
    "%p":0,
    "%s":0
  }
]
*/
```


### Attributes

- query
- sort
- meta
- MetaQuery
    > prepare to compile to sql string

### Usage

#### commonJS
```js
let sqlKit = require('sql-query');

new sqlKit({
  query:{
    $eq$status:1,
    $gte$money:10,
    $lte$money:100
  },
  sort:['-created'],
  meta:{
    limit:10,
    page:0,
    skip:0
  }
})

```

#### Angular

```js
require('sql-query');

angular.module('myApp',['ui.router','sql-query'])
  .controller('main',function(sqlKit){
    sqlKit({
        query:{
          $eq$status:1,
          $gte$money:10,
          $lte$money:100
        },
        sort:['-created'],
        meta:{
          limit:10,
          page:0,
          skip:0
        }
    });
  })

```


### Advance Usage

```js

// support endless nest in query

new sqlKit({
  query:{
    $eq$status:1,
    $gte$money:10,
    $lte$money:100,
    $or$and$eq$currency:'USD',
    $or$and$gt$money:100
  },
  sort:['-created'],
  meta:{
    limit:10,
    page:0,
    skip:0
  }
})

```

### Build

```bash
npm install

npm run build
```

### Test

```bash
npm run test
```

### License

what ever as you wish

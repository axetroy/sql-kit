!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.sqlKit=r():t.sqlKit=r()}(this,function(){return function(t){function r(i){if(e[i])return e[i].exports;var s=e[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}var e={};return r.m=t,r.c=e,r.p="",r(0)}([function(t,r,e){"use strict";function i(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function s(t){var r="";try{r=JSON.stringify(t)}catch(e){r=""}return r}function o(t){var r={};try{r=JSON.parse(t)}catch(e){r={}}return r}var n=function(){function t(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(r,e,i){return e&&t(r.prototype,e),i&&t(r,i),r}}(),a=e(1),u=e(2),h=e(4),c=e(3),f=c.DEFAULT_QUERY,p=c.DEFAULT_SORT,l=c.DEFAULT_LIMIT,v=c.DEFAULT_PAGE,y=c.DEFAULT_SKIP,m=c.DEFAULT_ENTITY,d=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=r.query,s=void 0===e?f:e,o=r.sort,n=void 0===o?[p]:o,a=r.meta,u=void 0===a?{page:v,limit:l,skip:y}:a;i(this,t),this.query=s,this.sort=n,u.page=void 0!==u.page?u.page:v,u.limit=void 0!==u.limit?u.limit:l,u.skip=void 0!==u.skip?u.skip:y,this.meta=u,this._sortMatcher=/^([-\+])(\w+)$/i,this.generator()}return n(t,[{key:"generator",value:function(){return this.MetaQuery=[],this.MetaQuery[0]=a(this.query),this.MetaQuery[1]=h(this.sort),this.MetaQuery[2]=u(this.meta),this}},{key:"clearSort",value:function(){return this.sort=[],this.MetaQuery[1]=h(this.sort),this}},{key:"onlySort",value:function(t){return this.sort=[t],this.MetaQuery[1]=h(this.sort),this}},{key:"setSort",value:function(t){var r=this,e=t.match(this._sortMatcher),i=this.sort.some(function(t){return e[2]===t.match(r._sortMatcher)[2]});return i&&this.sort.length?this.sort.forEach(function(i,s){var o=i.match(r._sortMatcher);e[2]===o[2]&&(r.sort.splice(s,1),r.unshiftSort(t))}):this.unshiftSort(t),this.MetaQuery[1]=h(this.sort),this}},{key:"pushSort",value:function(t){var r=this,e=t.match(this._sortMatcher),i=this.sort.some(function(t){return e[2]===t.match(r._sortMatcher)[2]});return i?this.sort.forEach(function(i,s){var o=i.match(r._sortMatcher);e[2]===o[2]&&(r.sort.splice(s,1),r.sort.push(t))}):this.sort.push(t),this.MetaQuery[1]=h(this.sort),this}},{key:"popSort",value:function(){return this.sort.pop(),this.MetaQuery[1]=h(this.sort),this}},{key:"shiftSort",value:function(){return this.sort.shift(),this.MetaQuery[1]=h(this.sort),this}},{key:"unshiftSort",value:function(t){var r=this,e=t.match(this._sortMatcher),i=this.sort.some(function(t){return e[2]===t.match(r._sortMatcher)[2]});return i&&this.sort.length?this.sort.forEach(function(i,s){var o=i.match(r._sortMatcher);e[2]===o[2]&&(r.sort.splice(s,1),r.sort.unshift(t))}):this.sort.unshift(t),this.MetaQuery[1]=h(this.sort),this}},{key:"removeSort",value:function(t){var r=this;return this.sort.forEach(function(e,i){var s=e.match(r._sortMatcher);s[2]===t&&r.sort.splice(i,1)}),this.MetaQuery[1]=h(this.sort),this}},{key:"toParams",value:function(){return{limit:this.meta.limit,page:this.meta.page,skip:this.meta.skip,query:encodeURIComponent(s(this.query)),sort:encodeURIComponent(s(this.sort))}}},{key:"toString",value:function(){return this.generator(),JSON.stringify(this.MetaQuery)}}],[{key:"parserParams",value:function(t){return{limit:t.limit,page:t.page,skip:t.skip,query:o(decodeURIComponent(t.query)),sort:o(decodeURIComponent(t.sort))}}}]),t}();"undefined"!=typeof angular&&angular.module("sql-query",["ui.router"]).provider("sqlKit",function(){this.$get=["$state",function(t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{query:{},sort:[],meta:{}},e=r.query,i=void 0===e?{}:e,s=r.sort,o=void 0===s?[]:s,n=r.meta,a=void 0===n?{}:n,u=d.parserParams(t.params);return new d({query:angular.extend({},i,u.query),sort:angular.extend({},o,u.sort),meta:angular.extend({},a,{limit:u.limit,page:u.page,skip:u.skip})})}}]}),t.exports=d},function(t,r){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2],s=arguments[3],o=r["%"+t[0]]=r["%"+t[0]]||{};switch(t.length){case 0:break;case 1:void 0!==s?r["%"+t[0]][i]=s:void 0;break;default:return t.shift(),e(t,o,i,s)}return r}function i(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t.match(/((?=\$)?[^\$]+(?=\$))/gi),o=t.match(/((?=\$)?\w+(?!=\$))$/i);return e(s,i,o[1],r),i}function s(t){var r={};for(var e in t)t.hasOwnProperty(e)&&i(e,t[e],r);return r}t.exports=s},function(t,r,e){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{limit:o,page:n,skip:a},r=t.limit,e=void 0===r?o:r,i=t.page,s=void 0===i?n:i,u=t.skip,h=void 0===u?a:u;return{"%p":s,"%l":e,"%s":h}}var s=e(3),o=s.DEFAULT_LIMIT,n=s.DEFAULT_PAGE,a=s.DEFAULT_SKIP;t.exports=i},function(t,r){"use strict";var e={},i="-created",s=10,o=0,n=0,a={query:e,sort:[i],meta:{limit:s,page:o,skip:n}};r.DEFAULT_QUERY=e,r.DEFAULT_SORT=i,r.DEFAULT_LIMIT=s,r.DEFAULT_PAGE=o,r.DEFAULT_SKIP=n,r.DEFAULT_ENTITY=a},function(t,r,e){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return Array.isArray(t)?t:[t]}var s=e(3),o=s.DEFAULT_SORT;t.exports=i}])});